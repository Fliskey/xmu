# C程序设计

## 第八课 - 字符输入输出与字符验证

### 输入输出缓冲

#### 单字符I/O

```c
ch = getchar();
new_ch = putchar(ch);


while((ch = getchar()) != '\n'){
    ……
}
```

getchar()有缓冲区，输入的数据放到缓冲区，直到输入回车才开始读入，且会读空白字符



#### 缓冲

是内存的一个取余，用于从一个地方移动到另一个位置时临时存储数据

协调吞吐速度差距很大的设备之间数据传送



#### 输入流

缓冲区默认为空

读一个删一个

已空后，若能补充缓冲则暂停等待，否则返回EOF继续冲虚

程序结束后，缓冲区释放



键盘缓冲区

程序缓冲区



#### 输入缓冲

##### 分类

完全缓冲，遇到缓冲区满就发送并清空（文件）

行缓冲，遇到回车时发送并清空（键盘）

##### 优缺点

允许用户在输入结束前发现错误，即使修改

减少调用输入输出的负担（数据库）

交互式程序需要非缓冲



#### 无缓冲输入流的行为

读取一个马上显示（存）一个



#### 输入输出流

（stream）

掩盖底层差异，提供统一接口

替用户和操作系统底层I/O打交道

四个操作，开open、关close、读read、写write

| 常见设备 | 标准流                                 | 打开     | 关闭 | 读取 | 写入 |
| -------- | -------------------------------------- | -------- | ---- | ---- | ---- |
| 屏幕     | 标准输出流stdout<br />标准错误流stderr | 自动打开 | 不可 | 不可 | 可   |
| 键盘     | 标准输入流stdin                        | 自动打开 | 可   | 可   | 不可 |
| 打印机   | 打印流                                 | 可       | 可   | 不可 | 可   |
| 文件     | 文件流                                 | 可       | 可   | 可   | 可   |
| 网络     | 网络流                                 | 可       | 可   | 可   | 可   |



#### 输入流终止

Ctrl+Z 终止键盘输入

Ctrl+C 终止程序终止键盘输入

返回EOF





```c
FILE * fp;
char fname[50];
fp = fopen(fname,"r");
getc(fp);
fclose(fp);
```



#### 流的重定向

用函数重定向到其他流



### 友好用户界面

软件工程更应该注重的地方

- 主体功能时基础

- 软件在用户各种可能的输入下不会崩溃也很重要

解决初级用户的输入错误

- 需要解决多余回车的问题

- 需要解决不慎按错键的问题



要用上`scanf`的返回值

可以用上assert函数：`assert(i-j-1>0 && i-j-1<N)`